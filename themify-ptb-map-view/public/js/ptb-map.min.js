function PTB_MapView(m,r){function d(e,a,f){g(e).css({height:a.h,width:a.w+("%"==a.wt?"%":"")});var b=a.r;"ROADMAP"==b?b=google.maps.MapTypeId.ROADMAP:"SATELLITE"==b?b=google.maps.MapTypeId.SATELLITE:"HYBRID"==b?b=google.maps.MapTypeId.HYBRID:"TERRAIN"==b&&(b=google.maps.MapTypeId.TERRAIN);$mobile&&a.dm&&(a.d=!1);var b={center:new google.maps.LatLng(-34.397,150.644),mapTypeId:b,scrollwheel:a.s?!0:!1,draggable:a.d?!0:!1},n=new google.maps.Map(e,b);e=new google.maps.LatLngBounds;var b=[],h={},d=-1!==
a.m.indexOf("http"),m={minWidth:245,maxWidth:300,arrowSize:15,arrowPosition:50,arrowStyle:0,padding:10,disableAutoPan:!1,borderWidth:1,borderRadius:8,borderColor:"#4dc7ec",closeSrc:ptb_map.url+"img/close.png"},k;for(k in f){var c=f[k].l;if(c.place){c.place=JSON.parse(c.place);c.place.location.lat=c.place.location[0]?parseFloat(c.place.location[0]):parseFloat(c.place.location.lat);c.place.location.lng=c.place.location[1]?parseFloat(c.place.location[1]):parseFloat(c.place.location.lng);var p=c.place.location.lat+
c.place.location.lng;if(void 0===h[p]){var l=new MarkerWithLabel({map:n,anchorPoint:new google.maps.Point(0,-29),title:f[k].t,icon:d?a.m:a.m?" ":"",raiseOnDrag:!0,labelContent:d?"":'<i class="ptb_map_icon fa fa-'+a.m+'"></i>'});h[p]=[];h[p].push(f[k]);l.setPosition({lat:c.place.location.lat,lng:c.place.location.lng});n.setCenter({lat:c.place.location.lat,lng:c.place.location.lng});l.setVisible(!0);e.extend(l.getPosition());b.push(l);var q=new InfoBubble(m);google.maps.event.addListener(l,"click",
function(a,b){return function(){var b=a.getPosition(),b=b.lat()+b.lng();q.setContent(t(h[b]));q.open(n,a);g(q.bubble_).addClass("ptb_map_view_wrapper")}}(l,k))}else h[p].push(f[k])}}0<b.length&&(n.fitBounds(e),new MarkerClusterer(n,b))}function t(e){var a='<ul class="ptb_map_view_info_window'+(1<e.length?" ptb_map_multiple":"")+'">',f;for(f in e){var b=e[f].i,d=e[f].t,h=e[f].u,g=e[f].l.info,a=a+"<li>";b&&(a+='<a class="ptb_map_view_post_img" href="'+h+'"><img src="'+b+'" alt="'+d+'" title="'+d+'" /></a>');
a+='<a class="ptb_map_view_post_title" href="'+h+'">'+d+"</a>";g&&(g=g.replace(/(?:\r\n|\r|\n)/ig,"<br />"),a+='<div class="ptb_map_view_info">'+g+"</div>");a+="</li>"}return a+"</ul>"}var g=jQuery;PTB.LoadAsync(ptb_map.url+"js/markerwithlabel.min.js",function(){PTB.LoadAsync(ptb_map.url+"js/infobubble.min.js",function(){PTB.LoadAsync(ptb_map.url+"js/markerclusterer.min.js",function(){g(".ptb_map_view").each(function(){var e=JSON.parse(window.atob(g(this).data("map"))),a=JSON.parse(window.atob(g(this).data("posts")));
d(this,e,a);g(this).data({posts:null,map:null}).removeAttr("data-posts data-map")})},null,ptb_map.ver,function(){return"undefined"!==typeof MarkerClusterer})},null,ptb_map.ver,function(){return"undefined"!==typeof InfoBubble})},null,ptb_map.ver,function(){return"undefined"!==typeof MarkerWithLabel})}
(function(m){m(document).ready(function(){if(0<m(".ptb_map_view").length)if("object"!==typeof google||"object"!==typeof google.maps){var r="//maps.googleapis.com/maps/api/js?v=3&signed_in=false&callback=PTB_MapView&language="+ptb_map.lng+"&key="+ptb_map.map_key,d=document.createElement("script");d.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(d);d.defer=!0;d.async=!0;d.src=r}else PTB_MapView()})})(jQuery);
